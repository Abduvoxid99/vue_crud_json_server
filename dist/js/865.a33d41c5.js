"use strict";(self["webpackChunkvue_admin"]=self["webpackChunkvue_admin"]||[]).push([[865],{98865:function(t,e,a){a.r(e),a.d(e,{default:function(){return g}});var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"row"},[a("a-button",{on:{click:function(e){return t.$router.push({path:"/"})}}},[t._v("back")]),a("div",{staticClass:"search"},[a("span",[t._v("Search:")]),a("a-input-search",{attrs:{size:"large",placeholder:"Search"},on:{change:t.onSearch}})],1),a("div",{staticClass:"search"},[a("span",[t._v("Filter by Autor:")]),a("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",size:"large"},on:{change:t.filterAutor}},t._l(t.data,(function(e){return a("a-select-option",{key:e.autor,attrs:{value:e.autor}},[t._v(" "+t._s(e.autor)+" ")])})),1)],1),a("div",{staticClass:"search"},[a("span",[t._v("Filter by Genre:")]),a("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",size:"large"},on:{change:t.filterByGenre}},t._l(t.genresComputed,(function(e,o){return a("a-select-option",{key:o,attrs:{value:e}},[t._v(" "+t._s(e)+" ")])})),1)],1),a("div",[a("a-button",{on:{click:function(e){return t.RandomGenerate()}}},[t._v(" Random genereate ")])],1),a("div",[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push({path:"/quote/create"})}}},[t._v(" Create + ")])],1)],1),a("a-table",{attrs:{columns:t.columns,"row-key":function(t){return t.id},"data-source":t.data,loading:t.loading,scroll:{x:1400,y:500}},scopedSlots:t._u([{key:"autor",fn:function(e){return[t._v(" "+t._s(e)+" ")]}},{key:"actions",fn:function(e){return a("span",{staticClass:"actions"},[a("a-button",{on:{click:function(a){return t.showModal(e)}}},[a("a-icon",{attrs:{type:"eye"}})],1),a("delete-btn",{on:{confirm:function(a){return t.deleteQuote(e)}}}),a("a-popconfirm",{attrs:{title:"Вы хотите это удалить?","ok-text":"Да","cancel-text":"Нет"},on:{confirm:function(a){return t.deleteQuote(e)},cancel:function(t){return null}}},[a("a-tooltip",{attrs:{placement:"bottomLeft",title:"delete"}},[a("a-button",{attrs:{type:"danger",icon:"delete"}})],1)],1),a("edit-btn",{on:{click:function(a){return t.$router.push({path:"/quote/"+e.id})}}}),a("a-tooltip",{attrs:{placement:"bottomLeft",title:"edit"}},[a("a-button",{staticClass:"mx-1",attrs:{type:"primary",icon:"edit"},on:{click:function(a){return t.$router.push({path:"/quote/"+e.id})}}})],1)],1)}}])}),a("a-modal",{attrs:{title:"Modal"},on:{ok:t.handleOk},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("div",{staticClass:"content"},[a("h3",[t._v("Quote:")]),a("p",[t._v(t._s(t.modalData.quote))])]),a("div",{staticClass:"content"},[a("h3",[t._v("Autor name:")]),a("p",[t._v(t._s(t.modalData.quote))])]),a("div",[a("h3",[t._v("Genres:")]),a("ul",t._l(t.modalData.genres,(function(e){return a("li",{key:e},[t._v(" "+t._s(e.genre)+" ")])})),0)])])],1)},n=[],s=(a(26699),a(26166)),r=a.n(s),i=a(17133),l=a.n(i),c=a(34665);const d="http://localhost:3000/quotes/";let u=setTimeout((()=>{}),0);const h=t=>r().get(d,{params:t}),f=[{title:"Autor",dataIndex:"autor",width:"20%",scopedSlots:{customRender:"autor"}},{title:"Quote",dataIndex:"quote",width:"20%"},{title:"Created At",dataIndex:"created_at",width:"20%",defaultSortOrder:"descend",sorter:(t,e)=>l()(t.created_at).format("X")-l()(e.created_at).format("X"),sortDirections:["descend","ascend"]},{title:"Updated At",dataIndex:"updated_at",width:"20%",defaultSortOrder:"descend",sorter:(t,e)=>l()(t.updated_at).format("X")-l()(e.updated_at).format("X"),sortDirections:["descend","ascend"]},{title:"Actions",scopedSlots:{customRender:"actions"},key:"actions",width:165}];var m={data(){return{data:[],loading:!1,columns:f,visible:!1,modalData:{}}},mounted(){this.fetch()},computed:{...(0,c.Se)(["randoms"]),genresComputed(){const t=this.data.map((t=>t.genres.map((t=>t.genre)))).flat();let e=[...new Set(t)];return e}},watch:{},methods:{RandomGenerate(t=1,e=this.data.length){let a=e-t,o=Math.random();o=Math.floor(o*a),o+=t,this.randoms.includes(o)?this.RandomGenerate(t=1,e=this.data.length):this.showModal(this.data[o]),this.showModal(this.data[o]),console.log("this",this.randoms),this.$store.dispatch("addToRandoms",o)},async deleteQuote(t){await r()["delete"](`${d}${t.id}`).then((t=>{console.log(t),this.$message.success("Successfully deleted"),this.fetch()})).catch((t=>{console.log(t)}))},filterAutor(t){this.fetch({autor:t})},filterByGenre(t){void 0===t&&this.fetch();const e=[];this.data.forEach((a=>a.genres.forEach((o=>{o.genre.toLowerCase().includes(t.toLowerCase())&&e.push(a)})))),this.data=e},onSearch(t){const e=t.target.value;clearTimeout(u),u=setTimeout((()=>{this.fetch({q:e})}),800)},fetch(t={}){this.loading=!0,h({...t}).then((({data:t})=>{this.loading=!1,this.data=t}))},showModal(t){this.modalData=t,this.visible=!0},handleOk(){this.visible=!1}}},p=m,v=a(1001),_=(0,v.Z)(p,o,n,!1,null,"2f47d06c",null),g=_.exports}}]);
//# sourceMappingURL=865.a33d41c5.js.map